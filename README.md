# 🏨 W Hotel 客戶評價分析儀表板

這是一個使用 **Streamlit** 建立的互動式資料視覺化儀表板，用於分析 W Hotel 的客戶評價數據。

## ✨ 功能特色

- 📊 **即時互動篩選**: 日期範圍、星級、情感篩選
- 📈 **多維度趨勢分析**: 月度、年度、情感趨勢
- 🎯 **評分維度分析**: 7 個服務維度的深度分析
- 🌟 **視覺化圖表**: 時間序列、長條圖、雷達圖、圓餅圖等
- 💬 **評論瀏覽**: 可排序的評論內容瀏覽
- 📥 **資料下載**: 支援下載篩選後的資料

## 🚀 快速開始

### 1. 安裝相依套件

```bash
pip install -r requirements.txt
```

或者手動安裝：

```bash
pip install streamlit pandas plotly openpyxl numpy
```

### 2. 執行應用程式

在專案目錄下執行：

```bash
streamlit run app.py
```

應用程式會自動在瀏覽器開啟，預設網址為 `http://localhost:8501`

### 3. 使用儀表板

- **側邊欄篩選器**: 使用左側的篩選器來選擇日期範圍、星級和情感
- **KPI 指標**: 查看頂部的關鍵指標
- **趨勢分析**: 切換不同的標籤頁查看月度、年度和情感趨勢
- **維度評分**: 查看各服務維度的表現
- **評論瀏覽**: 滾動到底部查看具體評論內容
- **下載資料**: 點擊下載按鈕匯出篩選後的資料

## 📦 檔案結構

```
DataAnalysis_ABSA/
├── app.py                    # Streamlit 應用程式主檔案
├── chat_W_hotel.xlsx         # Excel 數據檔案
├── requirements.txt          # Python 套件相依清單
└── README.md                 # 說明文件
```

## 🎨 儀表板功能詳解

### KPI 指標卡
- 總評論數
- 平均星級
- 正面評價比例
- 負面評價比例
- 時間跨度

### 趨勢分析
1. **月度趨勢**: 顯示每月平均星級和評論數量
2. **年度趨勢**: 顯示每年平均星級和統計表
3. **情感趨勢**: 顯示正面、中性、負面評論的時間分布

### 維度分析
- 員工服務
- 地點位置
- 房間與浴室品質
- 環境
- 設施
- 餐飲
- 性價比

### 分布分析
- 星級分布直方圖
- 情感分布圓餅圖

## 🛠️ 技術堆疊

- **Streamlit**: Web 框架
- **Pandas**: 數據處理
- **Plotly**: 互動式圖表
- **OpenPyXL**: Excel 檔案讀取
- **NumPy**: 數值計算

## 📊 數據欄位說明

- `date`: 評論日期
- `name`: 評論者姓名
- `star`: 星級評分 (1-5)
- `sentiment`: 情感分數 (-1: 負面, 0: 中性, 1: 正面)
- `text`: 評論文字內容
- `r_sentiment.*`: 各維度的情感分數
- `reasons.*`: 各維度的評論原因

## 🎯 進階使用

### 自訂部署

您可以將此應用部署到：

1. **Streamlit Community Cloud** (免費)
   - 註冊 https://streamlit.io/cloud
   - 連接您的 GitHub 儲存庫
   - 點擊部署

2. **Heroku**
   - 需要額外的 `Procfile` 和 `setup.sh`

3. **Docker**
   - 建立 Dockerfile 進行容器化部署

### 效能優化建議

- 使用 `@st.cache_data` 快取大型數據
- 限制圖表的數據點數量
- 使用分頁載入大量評論

## 🐛 常見問題

**Q: 應用無法啟動？**
A: 確保所有套件已正確安裝，並檢查 Python 版本 (建議 3.8+)

**Q: 圖表無法顯示？**
A: 檢查數據檔案 `chat_W_hotel.xlsx` 是否在相同目錄下

**Q: 如何更改配色？**
A: 修改 `app.py` 中的 `marker_color` 和 `color_discrete_map` 參數

## 📝 授權

此專案僅供學習和個人使用。

## 🤝 貢獻

歡迎提出問題和改進建議！

---

**開發者**: Claude Code
**更新日期**: 2025-11-11
